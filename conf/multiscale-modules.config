params {
    multiscale_with_spark_cluster  = true
    spark_local_dir                = null
    skip_multiscale                = true
    multiscale_spark_workers       = 2
    multiscale_min_spark_workers   = 1
    multiscale_spark_worker_cores  = 1
    multiscae_spark_gb_per_core    = 15
    multiscale_spark_driver_cores  = 1
    multiscale_spark_driver_mem_gb = 1
}

process {

    withName:"(.*)?SPARK_.*" {
        container = 'ghcr.io/janeliascicomp/stitching-spark:1.11.0-rc2'
    }

    withName:"(.*)?STITCHING:STITCHING_.*" {
        errorStrategy = 'terminate'
        container = 'ghcr.io/janeliascicomp/stitching-spark:1.11.0-rc2'
    }

    withName: "(.*)?SPARK_STARTMANAGER" {
        errorStrategy = 'terminate'
        ext.spark_local_dir = params.spark_local_dir ? params.spark_local_dir : ''
        ext.sleep_secs = 2
    }

    withName: "(.*)?SPARK_STARTWORKER" {
        errorStrategy = 'terminate'
        ext.sleep_secs = 2
    }

    withName: "(.*)?SPARK_WAITFORMANAGER" {
        errorStrategy = 'terminate'
        ext.sleep_secs = 2
        ext.max_wait_secs = 7200
    }

    withName: "(.*)?SPARK_WAITFORWORKER" {
        errorStrategy = 'terminate'
        ext.sleep_secs = 2
        ext.max_wait_secs = 7200
    }

}
